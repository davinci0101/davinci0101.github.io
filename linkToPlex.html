<html>
    <head>
	    <script type="text/javascript">
            function getParameter(name) {
                name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
                var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                results = regex.exec(location.search);
                return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
            }
		
            function linkToPlex() {
                var mobile = (/iphone|ipad|ipod/i.test(navigator.userAgent.toLowerCase())); //안드로이드 제외 현재 미지원 |android
                var tUrl = "";
		if(!mobile) {
			//alert(navigator.maxTouchPoints);
                    if (navigator.maxTouchPoints > 0) {
			mobile = true;
		    } else {
			mobile = false;
		    }    
		}	
				var pkey = getParameter("pkey");
				var ptype = getParameter("ptype");
				var pserver = getParameter("pserver");
                if(mobile) { 
                    tUrl = "plex://preplay/?metadataKey=" + pkey + "&metadataType=" + ptype + "&server=" + pserver;
			                setTimeout("window.close()", 3000);
					myWindow = window.open(tUrl, "_self");
					myWindow.close();
			                window.close();
                }else{
                    tUrl = "https://app.plex.tv/desktop#!/server/" + pserver + "/details?key=" + pkey;
					myWindow = window.open(tUrl, "_self");
                }
            }
        </script>
	</head>
	<body onload="linkToPlex();">
	</body>
</html>
